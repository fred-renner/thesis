\chapter{Physical Object Reconstruction}\label{ch:reco}

Physical properties of particles produced from a collision at the \ac{lhc} is derived by combining the traces these particles leave in the various subdetectors on their way through \ac{atlas}. This  reconstruction is described in the following for objects used in this analysis. The main resource for this chapter is \citep{atlas2021optimisation}.

\section{Tracks and Primary Vertex}\label{sec:tracks}
Charged particles leave a trajectory in the \ac{id} as explained in the section \ref{sec:inner_detector}. To reconstruct the path of these particles an algorithm first groups hits that are close to each other in the silicon detectors into clusters. These clusters are then successively combined to determine the most probable trajectory that the particles have taken through the detector which are referred to as tracks \citep{aaboud2017performance}. These are then geometrically matched to proton-proton interactions and the vertex with the largest scalar sum of transverse momentum $\sum \pt^2$ becomes the primary hard scatter vertex. In addition, the momentum is also determined based on the curvature of the particle through the magnetic field and at least two tracks with $\pt>\qty[]{500}{MeV}$ are required in the tracking volume $\abs{\eta}<2.5$.

\section{Jets}\label{sec:jets}
As explained in section \ref{sec:renormalization} quarks cannot be observed individually but only as colorless hadrons. When decaying they undergo showering and hadronization forming cone-like structures of energy deposits in the detector called jets. They are reconstructed by combining tracking and calorimeter information.

\subsection{Topocluster}
For that purpose the deposited energy of these decays in the calorimeters are grouped three-dimensionally by combining calorimeter cells into so-called topoclusters. These clusters are seeded from cells that display a signal stronger than four times the standard deviation of detector noise $4\sigma_\mathrm{noise}$ and is complemented by $2\sigma_\mathrm{noise}$ cells.

\subsection{Particle Flow Object}
The energy and mass resolution calculated from these clusters can be improved by geometrically matching tracks to the clusters. If a track is matched successfully to a topocluster the energy of the track and the position in the calorimeter is used to infer the energy of the particle that created the track. From this expected energy all associated cluster cell energies are subtracted and the remnant is removed from the expected energy if the deviation corresponds to energies of the order of typical fluctuations. Such combination of a topocluster and a track are called \ac{pfo} \citep{aaboud2017jet}. Sometimes energy of one track ends up in several clusters. For this the Particle Flow algorithm combines the most probable clusters with the track. Topoclusters without matched tracks are assumed to be neutral particles as they do not leave a trace in the \ac{id}. \acp{pfo} not matched to the \ac{pv} are removed to reduce the contribution from pileup. In particular it improves reconstruction of lower \pt clusters since the \ac{id} has a much better resolution.

\subsection{Track-CaloClusters}
Instead of using the energy measurement of the tracks as for \acp{pfo} for \ac{tcc} the calorimeter energy measurement is used and complemented by the angular information of the tracks. \ac{tcc} was developed for high \pt jets since the resolution in the calorimeters improves with larger momentum since the calorimeter deposits become more localized.

% \subsection{Unified Flow Object}
% Particle Flow benefits from the momentum/energy resolution of the \ac{id} compared to the calorimeters especially at low momenta. Although this gradually breaks down with increasing momentum and also with particle density because the matching of tracks to clusters becomes more and more ambiguous in that case. \ac{ufo} jets are designed to make the most of both reconstruction algorithms by choosing the algorithm that performs best for the situation at hand.

\subsection{Anti-$k_t$ Jet Clustering Algorithm}\label{sec:anti_kt}
The definition of a jet is not unique as it depends on the size and direction of the cone and thus how many particles are included. For this the Anti-$k_t$ algorithm \citep{cacciari2008anti} clusters aforementioned four vector objects in this section into cone-shaped jets. It starts with calculating the distances between all four vector objects $i,j$ that are considered
\begin{equation}
  d_{ij}=\frac{1}{\max(p_{T,i}^{2}\,,\,p_{T,j}^{2})} \frac{\Delta R_{ij}^2}{R^2},
\end{equation}
and the distance to the beam
\begin{equation}
  d_{iB}=\frac{1}{p_{T,i}^{2}},
\end{equation}
with the transverse momenta of the particles $p_{T,i},p_{T,j}$ their angular distance $\Delta R$ as of equation \ref{eq:delta_R} and a chosen radius parameter $R$. The algorithm combines objects $i,j$ into a new four vector for the smallest distance $d_{ij}$. Since this distance is small for large transverse momentum \pt and small angular distance $\Delta R_{ij}$ the algorithm prefers these accordingly. After combining two object the algorithm starts for as long as $d_{iB}<d_{ij}$. Thus it stops once particles outside of the chosen radius would be added. In \ac{atlas} jets with  a radius parameter of $R=0.4 (1.0)$ are usually denoted as Small-R(Large-R) jets.


\subsection{Variable Radius Jets}\label{sec:vr_jets}
In very boosted regimes mit large momenta individual jets can overlap. In order to still reconstruct them individually a \ac{vr} for the $R$ parameter from the Anti-$k_t$ Jet Clustering Algorithm of section \ref{sec:anti_kt} is used
\begin{equation}
  R\rightarrow R_\text{eff}(\pt)=\frac{\rho}{\pt}
\end{equation}
It becomes therefore dependent on the transverse momentum and is controlled by a parameter $\rho$ so that the jet size decreases with \pt. \ac{vr} jets are reconstructed from tracks and are required to have $\pt>\qty[]{10}{GeV}$.

\section{$b$-tagging}\label{sec:b_tagging}
This analysis has four $b$-quarks in the final state and therefore relies on their identification.  Fortunately, due to their large mass $\tau\sim\qty{1.5}{ps}$, $b$ quarks have a long lifetime compared to other quarks resulting in a path length of about $c\tau\sim\qty{450}{\micro m}$. Even though they do not reach the \ac{id} a secondary vertex is formed at the point where the $b$-hadron decays which can be inferred from the tracks.

Such tracks have a large impact parameter that is defined as the distance of closest approach in the $r-\phi$ projection in transverse $d_0$ and longitudinal $z_o$ direction \citep{aad2008atlas} as illustrated in figure \ref{fig:secondary_vertex}b. Other methods for determining the secondary vertex attempt to connect the tracks of the $b$-hadron decay with those of a subsequent $c$-hadron decay by aligning the tracks in Fig. \ref{fig:secondary_vertex}a and also by deriving the mutual origins of the tracks \citep{ATL-PHYS-PUB-2017-013}.
\begin{figure}[]
  \centering
  \subfigure[]{
    \includegraphics[width=0.49\textwidth]{secVexMguth}
  }%\hspace*{1cm}
  \subfigure[]{
    \includegraphics[width=0.49\textwidth]{SV_sketch}
  }
  \caption{(a) Example decay involving a $b$-jet (\hexbox{8AB2D3}) and jets from light flavor hadrons (\hexbox{C5C6C6}). (b) Impact parameters defined for tracks as distance of closest approach to the primary vertex for (\mbox{\color[HTML]{009245}{$d_0$}}) in the $r-\phi$-plane and for (\mbox{\color[HTML]{EC1C25}{$z_0$}}) along the z axis. (a) Adopted from \cite{Guth:2765038}.}
  \label{fig:secondary_vertex}
\end{figure}

\subsection{DL1r Tagger}
The results of the secondary vertex- and impact parameter finding algorithm as well as the jet kinematics are then passed into a deep feed-forward neural network called DL1r which is trained to distinguish $b$-jets from jets of other flavors \citep{atlas2022atlas}. The outputs nodes for flavor classification ($p_\mathrm{b}, p_\mathrm{c}, p_\mathrm{light}$) are further combined into a single discriminating score variable
\begin{equation}
  D_\mathrm{DL1r}=\ln\left(\frac{p_b}{f_c \cdot p_c + (1-f_c)\cdot p_\mathrm{light} }\right).
\end{equation}
$f_c$ is the fraction of charm jets in the background and can be used to tune the importance of the different background classes ($\sum f_\mathrm{bkg} =1$). When evaluating the \ac{nn} a value for the discriminating variable can be derived that corresponds to a $b$-jet selection efficiency which is then applied in physics analysis.

\subsection{$X\rightarrow bb$ Tagger}\label{sec:xbb}
For a collision event where the decay products consists of $b$-jets with large transverse momentum they can overlap. For such cases \ac{vr} track jets from section \ref{sec:vr_jets} can be reconstructed from inside large-$R$ jets that encompass both $b$-jets. The \ac{vr} jets are required to have $\rho=\qty[]{30}{GeV}$ and an allowed radius parameter range of $R_\text{min}=0.02$ and $R_\text{max}=0.4$. These parameters are optimized for Higgs to $bb$ decays \citep{ATL-PHYS-PUB-2017-010} and the \ac{vr} jets are not allowed to overlap.

The $X\rightarrow bb$ tagger is a feed-forward \ac{nn} \citep{ATL-PHYS-PUB-2020-019} that gets as inputs the \pt and $\eta$ of the large-$R$ jet and the output from DL1r for up to three \ac{vr} track jets. Similar to DL1r a discriminant is calculated from the output scores for Higgs, top and multijet decay of the event passed to the \ac{nn}
\begin{equation}
  D_{\text{Xbb}}=\ln\left({\frac{p_{\text{Higgs}}}{f_{\text{top}}\cdot p_{\text{top}}+(1-f_{\text{top}})\cdot p_{\text{multijet}}}}\right).
\end{equation}
$f_\text{top}$ denotes the top fraction with regards to the multijet output. Again from the evaluation a score can be defined with the Higgs tagging efficiency.

\section{Jet Calibration}\label{sec:calibration}
Every measuring instrument must be calibrated. The main causes of differences between properties of jets deduced from reconstruction compared to their true properties include \citep{atlas2011jet}:
\begin{itemize}
  \item Non-Compensation: smaller calorimeter response of non-\ac{em} particles of hadron showers than to \ac{em}
  \item Dead material: energy is deposited in non-instrumented areas
  \item Particles from the jet are outside of the reconstruction cone
  \item Energy deposition below the noise threshold
  \item Particles from pile-up
  \item Leakage: particles are not stopped inside the calorimeter (punch-through)
\end{itemize}
There are several algorithms employed to mitigate these effects and also account for the detector geometry fully described in \citep{atlas2021jet}.

\subsection{Pilup mitigation}
When bunches are collided not only one but rather several proton-proton interactions are measured. Methods to disentangle several interactions are described below and improved over time so the mean number of interactions also called pile up increased during the data taking period as can be seen in figure \ref{fig:pileup}.
\begin{figure}
  \centering
  \includegraphics[width=0.5\textwidth]{mu_2015_2018}
  \caption[]{Pile up profiles for run 2 data taking periods \citep{pileup}.}
  \label{fig:pileup}
\end{figure}

\subsubsection*{Small-R Jets}
At a first step contributions from pileup are reduced by subtracting the median transverse momentum density $\rho=\pt / A$ of jets found within $\eta<2.0$ multiplied by the active area of the jet $A_T$ as defined in \textsc{FastJet} \citep{cacciari2012fastjet}. Another reduction observes that the pileup corrected \pt is a function of the number of primary Vertices $N_\text{PV}$ and the mean number of interactions $\mu$ so that the pile up corrected transverse momentum reads
\begin{equation}
  \pt^\text{corr}=\pt-\rho A_T -\alpha(N_\text{PV}-1)-\beta\mu
\end{equation}
with parameters $\alpha$ and $\beta$. The effect of the correction is shown in figure \ref{fig:jet_pt_correction}.
\begin{figure}
  \centering
  \includegraphics[width=1\textwidth]{jet_pt_correction}
  \caption[]{\pt correction to remove the \pt dependence of the jet at different $\eta$ for the \pt dependent on (left) the number of primary vertices and (right) average number of interactions of the collision.}
  \label{fig:jet_pt_correction}
\end{figure}

Moreover pileup contributions can be further reduced by comparing the scalar \pt sum of tracks from the \ac{pv} associated to the jet with the scalar \pt sum of all tracks including other \acp{pv}. The \ac{jvt} \citep{ATLAS-CONF-2014-018} utilizes this property to apply a quality criterion on jets with $\pt<\qty[]{60}{GeV}$ and $|\eta|<2.4$.


\subsubsection*{Large-R Jets}
Due to the large Area of large-R jets they are particularly susceptible to pileup contributions and therefore a technique called groomming is applied. For this a large R jet is reclustered into $R=0.2$ subjets for which only the ones are kept that have at least $\pt>\qty[]{5}{\percent}$ of the original large R jet \pt.

\subsection{\ac{jes}, $\eta$ and mass}
\begin{figure}
  \centering
  \includegraphics[width=1\textwidth]{jet_eta_mismatch}
  \caption[]{Jet energy response $E_\text{reco}/E_\text{truth}$ for different detector $\eta$ values (left) before and after applying (right) the calibration. Adopted from \citep{jet_eta_calib}.}
  \label{fig:jet_eta_mismatch}
\end{figure}
A clear mismatch between reconstructed and \ac{mc} truth two jet events can be seen in the left plot of figure \ref{fig:jet_eta_mismatch} measured in $\eta$ bins. From this a continuous correction function in $\eta$ is derived and applied to correct for differences in jet energy, $\eta$ and mass. This is exemplified in the right hand plot of figure \ref{fig:jet_eta_mismatch}.

\subsection{Global Sequential Calibration}

This step mainly corrects the jet \pt without changing the mean energy of the jet. It corrects for non-compensation, dead material and leakage effects by using observables like the charged particle fraction, energy fractions in different calorimeter layers, track-related quantities and the muon activity behind the calorimeter. Corrections are again derived in \pt and $\eta$ and are applied sequentially.

\subsection{In situ calibration}
At the final step differences between data and simulation are corrected for in \pt. These variations stem from imperfect simulations of detector materials and the modeling of the involved physics processes. For this well known physics processes are used and correction factors are extracted in \pt. This step is only applied to data.

\subsection{Jet Event Cleaning}
Another method to reduce background is called event cleaning. It removes the whole event if jets are found that where generated by out-of-time pileup, cosmic rays or beam-induced backgrounds by applying a set of quality criteria to variables describing the jet profile \citep{ATLAS-CONF-2015-029}.

\subsection{Mass correction for Large-R jets}
The mass of a jet is calculated from the energy deposits in calorimeter clusters $i$ and their transverse momentum as
\begin{equation}
  m_{\text{calo}} = \sqrt{\left(\sum_{i\in \text{Jet}}E_i\right)^2-\left(\sum_{i\in \text{Jet}}\vec{p_i}\right)^2}.
\end{equation}
The spread of decay products inside large-R jets scales with $1/\pt$. For very boosted jets the spread can become the size of the granularity of the calorimeter and the energy resolution degrades. With the help of tracking information the energy and mass resolution can be improved across the whole \pt range \citep{Aaboud:2019aa}. The track assisted jet mass is then
\begin{equation}
  m_{\text{TA}} = \frac{p_{\text{T}}^{\text{calo}}}{p_{\text{T}}^{\text{track}}} \cdot m_{\text{track}}
\end{equation}
where $p_{\text{T}}^{\text{calo}}$ is the transverse momentum measured in the calorimeter, $p_{\text{T}}^{\text{track}}$ is the transverse momentum of the four-vector sum of tracks associated to the large-R jet and $m_\text{track}$ is the invariant mass of this four-vector sum of tracks. Since the \ac{id} is only susceptible to charged particles the ratio of $p_{\text{T}}^{\text{calo}}$ and $p_{\text{T}}^{\text{track}}$ scales the mass measured from tracks to include neutral particles. The improvement is visualized in figure \ref{fig:combined_mass_large_R}. The calorimeter and track-assisted mass measurement are then linearly combined with a weight $w$ to give optimal results
\begin{equation}
  m_{\text{comb}} =  w\cdot m_{\text{calo}}+(1-w)\cdot m_{\text{TA}}.
\end{equation}
\begin{figure}
  \centering
  \includegraphics[width=.5\textwidth]{combined_mass_large_R}
  \caption[]{Improvement for track-assisted mass measurement compared to calorimeter and tracking information only. Adopted from \citep{ATLAS-CONF-2016-035} }
  \label{fig:combined_mass_large_R}
\end{figure}
